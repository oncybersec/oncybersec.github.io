---
layout: post
status: publish
published: true
title: An Overview of the Apache Zero-Day Vulnerability (CVE-2021-41773)
author:
  display_name: oncybersec
  url: ''
wordpress_id: 613
wordpress_url: https://oncybersec.com/?p=613
date: '2021-10-10 12:12:25 +0200'
date_gmt: '2021-10-10 10:12:25 +0200'
tags:
- penetration testing
- security operations
- vulnerability management
comments: []
---
<p><!-- wp:paragraph --></p>
<p>Apache recently released patches for a zero-day vulnerability affecting versions 2.4.49 (<a rel="noreferrer noopener" href="https://nvd.nist.gov/vuln/detail/CVE-2021-41773" target="_blank">CVE-2021-41773</a>) and 2.4.50 (<a rel="noreferrer noopener" href="https://nvd.nist.gov/vuln/detail/CVE-2021-42013" target="_blank">CVE-2021-42013</a>) of its web server on both Windows and Linux servers. The zero-day vulnerability was a directory traversal that could allow an attacker to access arbitrary files on the web server. Directory traversal (also known as path traversal), is an attack that uses the sequence <code>../../../../</code> in the URL to access files that exist outside the web server document root. This can be exploited to access files that should never be accessed from the web server such as the <code>/etc/passwd</code> file via <code>../../../../etc/passwd</code>. In the case of this vulnerability, the attack was URL encoded as below where <code>%2e</code> is the URL-encoded equivalent of the dot character:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>/images/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>Where the vulnerability exists another issue arises where it can also lead to remote code execution if CGI scripts are enabled. In this case the directory traversal sequence is used to execute a command that is passed to the shell from the request body:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>curl --data 'echo; $cmd' '$host/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh'</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>This attack can be leveraged to execute arbitrary commands on the web server and ultimately lead to comprising the host. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>According to the Apache security <a rel="noreferrer noopener" href="https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2021-41773" target="_blank">advisory</a>, the vulnerability arose due to a change that was made in path normalization in Apache web server 2.4.49. This resulted in the URL path not being correctly validated and did not block the <code>%2e</code> sequences. While the issue was originally thought to only affect version 2.4.49, it was found that version 2.4.50 was also affected as the released patch was found to be an incomplete fix for the issue. This was because <code>%%32%65</code> (the URL-encoded equivalent of <code>%2e</code>) could be used to bypass the path validation that was used by version 2.4.50:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>/images/.%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/etc/passwd</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>As a result, Apache released another patch in <a rel="noreferrer noopener" href="https://httpd.apache.org/security/vulnerabilities_24.html#2.4.51" target="_blank">version 2.4.51</a>. However, the impact of the vulnerability is mitigated as it is not exploitable as long as the ‘require all denied’ configuration is present, which prevents accessing files outside the document root and is enabled by default.</p>
<p><!-- /wp:paragraph --></p>
